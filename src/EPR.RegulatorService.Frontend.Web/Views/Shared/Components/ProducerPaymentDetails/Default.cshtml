@using EPR.RegulatorService.Frontend.Core.Extensions
@using EPR.RegulatorService.Frontend.Web.Extensions
@using EPR.RegulatorService.Frontend.Web.ViewModels.RegistrationSubmissions
@using System.Globalization
@using EPR.RegulatorService.Frontend.Web.ViewModels.Shared.GovUK

@model ProducerPaymentDetailsViewModel
@{
    var errorsViewModel = new ErrorsViewModel(ViewData.ModelState.ToErrorDictionary(), Localizer);
}
<div class="govuk-summary-card">
    <div class="govuk-summary-card__title-wrapper" style="align-items: center;">
        <h2 class="govuk-summary-card__title">@Localizer["ProducerPaymentDetails.Title"] - ADDHERE submission period</h2>
        <ul class="govuk-summary-card__actions">
            <li class="govuk-summary-card__action"></li>
        </ul>
    </div>
    <div class="govuk-summary-card__content" style="padding-bottom: 0px;">
      @if (Model is not null)
        {
            <dl class="govuk-summary-list govuk-!-margin-bottom-4">

                <div class="govuk-summary-list__row" style="display: flex; justify-content: space-between;">
                    <dd class="govuk-summary-list__value" style="width: 285px;">
                        <strong>@Localizer["ProducerPaymentDetails.Items"]</strong>
                    </dd>
                    <dd class="govuk-summary-list__value" style="width: 410px;">
                        <strong>@Localizer["ProducerPaymentDetails.Description"]</strong>
                    </dd>
                    <dd class="govuk-summary-list__actions" style="text-align: right; flex-grow: 1;">
                        <strong>@Localizer["ProducerPaymentDetails.Amount"]</strong>
                    </dd>
                </div>

                <div class="govuk-summary-list__row" style="display: flex; justify-content: space-between;">
                    <dd class="govuk-summary-list__value" style="width: 285px;">
                        <strong>@Localizer["ProducerPaymentDetails.ChargeableItems"]</strong>
                    </dd>
                    <dd class="govuk-summary-list__value" style="width: 410px;"></dd>
                    <dd class="govuk-summary-list__actions" style="text-align: right; flex-grow: 1;"></dd>
                </div>

                <div class="govuk-summary-list__row" style="display: flex; justify-content: space-between;">
                    <dd class="govuk-summary-list__value" style="width: 285px;">
                        @Localizer["ProducerPaymentDetails.ApplicationProcessingFee"]
                    </dd>
                    <dd class="govuk-summary-list__value" style="width: 410px;">
                        @Localizer["ProducerPaymentDetails.FeeForProducerSize"]
                    </dd>
                    <payment-amount amount="@Model.ApplicationProcessingFee"></payment-amount>
                </div>

                <div class="govuk-summary-list__row" style="display: flex; justify-content: space-between;">
                    <dd class="govuk-summary-list__value" style="width: 285px;">
                        @Localizer["ProducerPaymentDetails.OnlineMarketplaceFee"]
                    </dd>
                    <dd class="govuk-summary-list__value" style="width: 410px;">
                        @Localizer["ProducerPaymentDetails.FeeForOwningAnOnlineMarketplace"]
                    </dd>
                    <payment-amount amount="@Model.OnlineMarketplaceFee"></payment-amount>
                </div>

                <div class="govuk-summary-list__row" style="display: flex; justify-content: space-between;">
                    <dd class="govuk-summary-list__value" style="width: 285px;">
                        @Localizer["ProducerPaymentDetails.SubsidiaryFee"]
                    </dd>
                    <dd class="govuk-summary-list__value" style="width: 410px;">
                        @Localizer["ProducerPaymentDetails.FeeForSubsidiaryOnlineMarketPlace"]
                    </dd>
                    <payment-amount amount="@Model.SubsidiaryFee"></payment-amount>
                </div>

                <div class="govuk-summary-list__row" style="display: flex; justify-content: space-between;">
                    <dd class="govuk-summary-list__value" style="width: 285px;">
                        @Localizer["ProducerPaymentDetails.LateRegistrationFeeTitle"]
                    </dd>
                    <dd class="govuk-summary-list__value" style="width: 410px;">
                        @Localizer["ProducerPaymentDetails.LateRegistrationFeeDescription"]
                    </dd>
                    <payment-amount amount="@Model.LateRegistrationFee"></payment-amount>
                </div>

                <div class="govuk-summary-list__row" style="display: flex; justify-content: space-between;">
                    <dd class="govuk-summary-list__value" style="width: 285px;">
                        <strong>@Localizer["ProducerPaymentDetails.TotalChargeableItems"]</strong>
                    </dd>
                    <dd class="govuk-summary-list__value" style="width: 410px;"></dd>
                    <payment-amount amount="@Model.TotalChargeableItems" property-name="TotalChargeableItems"></payment-amount>
                </div>

                <div class="govuk-summary-list__row" style="display: flex; justify-content: space-between;">
                    <dd class="govuk-summary-list__value" style="width: 285px;">
                        <strong>@Localizer["ProducerPaymentDetails.PreviousPaymentsReceived"]</strong>
                    </dd>
                    <dd class="govuk-summary-list__value" style="width: 410px;">
                        @Localizer["ProducerPaymentDetails.TotalPaymentsReceived"]
                    </dd>
                    <payment-amount amount="@Model.PreviousPaymentsReceived" property-name="PreviousPaymentsReceived"></payment-amount>
                </div>

                <div class="govuk-summary-list__row" style="display: flex; justify-content: space-between;">
                    <dd class="govuk-summary-list__value" style="width: 285px;">
                        <strong>@Localizer["ProducerPaymentDetails.TotalOutstanding"]</strong>
                    </dd>
                    <dd class="govuk-summary-list__value" style="width: 410px;"></dd>
                    <payment-amount amount="@Model.TotalOutstanding" property-name="TotalOutstanding"></payment-amount>
                </div>
            </dl>
            <hr class="govuk-section-break govuk-section-break--m govuk-section-break--visible" />

            @using (Html.BeginRouteForm("SubmitPaymentInfo", new { submissionId = ViewBag.OrganisationId }, FormMethod.Post))
            {
                <div class="govuk-!-width-one-half govuk-form-group @(errorsViewModel.HasErrorKey(nameof(Model.OfflinePayment)) ? " govuk-form-group--error" : "")">
                    <label class="govuk-label" for="@nameof(Model.OfflinePayment)">
                        @Localizer["ProducerPaymentDetails.OfflinePaymentDetailsTitle"]
                    </label>
                    <br>
                    <div id="@nameof(Model.OfflinePayment)-hint" class="govuk-hint">
                        @Localizer["ProducerPaymentDetails.OfflinePaymentDetailsHint"]
                    </div>
                    @(await Html.PartialAsync("Partials/Govuk/_FormItemError", errorsViewModel[nameof(PaymentDetailsViewModel.OfflinePayment)]))
                    <div class="govuk-input__wrapper">
                        <div class="govuk-input__prefix" aria-hidden="true">Â£</div>
                        <input class="govuk-input govuk-input--width-10 @(errorsViewModel.HasErrorKey(nameof(Model.OfflinePayment)) ? " govuk-input--error" : "")"
                               id="@nameof(Model.OfflinePayment)"
                               name="@nameof(Model.OfflinePayment)"
                               type="text"
                               value="@Model.OfflinePayment"
                               spellcheck="false"
                               aria-describedby="@nameof(Model.OfflinePayment)-hint">
                    </div>
                    <button type="submit"
                            class="govuk-button epr-horizontal-control epr-horizontal-control-button govuk-!-margin-right-6"
                            data-module="govuk-button">
                        @Localizer["ProducerPaymentDetails.OfflinePaymentDetailsSubmit"]
                    </button>
                </div>
            }
        }
        else
        {
            <p class="govuk-body">Unable to retrieve producer payment details</p>
        }
        
    </div>
</div>
